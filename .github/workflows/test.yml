name: Tests

on:
  - push
  - pull_request

jobs:
  tests:
    runs-on: ubuntu-latest
    env:
      ci_env: bash <(curl -s https://codecov.io/env)
    steps:
    - uses: actions/checkout@v2.3.4
    - uses: docker/build-push-action@v2
      with:
          context: ./
          file: ./Dockerfile
          tags: test-ezconda:latest
          push: false

    - uses: addnab/docker-run-action@v3
      with:
        image: test-ezconda:latest
        options: $ci_env -e CI=true
